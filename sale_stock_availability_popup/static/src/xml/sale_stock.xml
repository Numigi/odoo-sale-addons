<?xml version="1.0" encoding="utf-8"?>
<templates>

    <div t-extend="sale_stock.qtyAtDate">
        <t t-jquery="a" t-operation="replace">
                <a tabindex="0" t-attf-class="fa fa-area-chart {{widget.data.qty_popup_color}}"/>

        </t>
    </div>
    <div t-extend="sale_stock.QtyDetailPopOver">
        <t t-jquery="tbody" t-operation="replace">
            <tbody>
                <t t-if="!data.is_mto and ['draft', 'sent'].includes(data.state)">
                    <tr>
                        <td><strong>Forecasted Stock</strong><br /><small>On <span t-esc="data.delivery_date"/></small></td>
                        <td><b t-esc='data.virtual_available_at_date'/>
                        <t t-esc='data.product_uom.data.display_name'/></td>
                    </tr>
                    <tr>
                        <td><strong>Available</strong><br /><small>All planned operations included</small></td>
                        <td><b t-esc='data.available_qty' t-att-class="!data.will_be_fulfilled ? 'text-danger': ''"/>
                        <t t-esc='data.product_uom.data.display_name'/></td>
                    </tr>
                </t>
                <t t-elif="data.is_mto and ['draft', 'sent'].includes(data.state)">
                    <tr>
                        <td><strong>Expected Delivery</strong></td>
                        <td class="oe-right"><span t-esc="data.delivery_date"/></td>
                    </tr>
                    <tr>
                        <p>This product is replenished on demand.</p>
                    </tr>
                </t>
                <t t-elif="data.state == 'sale'">
                    <tr>
                        <td>
                            <strong>Reserved</strong><br/>
                        </td>
                        <td style="min-width: 50px; text-align: right;">
                            <b t-esc='data.reserved_qty
'/> <t t-esc='data.product_uom.data.display_name'/>
                        </td>
                    </tr>

                    <tr>
                        <td><strong>Available</strong><br /><small>All planned operations included</small></td>
                        <td><b t-esc='data.available_qty'/>
                        <t t-esc='data.product_uom.data.display_name'/></td>
                    </tr>
                </t>
            </tbody>
        </t>
    </div>
</templates>
